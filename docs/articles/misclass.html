<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controlling misclassification bias in longitudinal udder health studies • misclass</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">misclass</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/misclass.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Controlling misclassification bias in longitudinal udder health studies</h1>
                        <h4 class="author">Denis Haine</h4>
            
            <h4 class="date">2017-11-24</h4>
          </div>

    
    
<div class="contents">
<p>Using imperfect tests may lead to biased estimates of disease frequency and of associations between risk factors and disease. For instance in longitudinal udder health studies, both quarters at risk and incident intramammary infections (IMI) can be wrongly identified, resulting in selection and misclassification bias, respectively. Diagnostic accuracy can possibly be improved by using duplicate or triplicate samples for identifying quarters at risk and, subsequently, incident IMI.</p>
<p>This package allows the udder health researcher to estimate the potential biases that would be present in his/her study according to pathogen, population, and test characteristics. Improvement in sensitivity (Se) and/or specificity (Sp) of the tests can also be assessed with the package to help the design and planning of the study. The package was developed for the paper <a href="https://doi.org/10.1016/j.prevetmed.2017.11.010">Diagnosing intramammary infection: Controlling misclassification bias in longitudinal udder health studies</a>, by D. Haine, I. Dohoo, D. Scholl, and S. Dufour. Full description of the methodology is provided in the above paper. The approach in the paper used many simulations to explore various biases ( i.e. had to resort to cloud computing for these lengthy simulations), but the researcher interested in assessing his/her study design can use the package with less simulations to have an indication on the best planning for his/her study. This is what is presented hereafter.</p>
<p>The package is installed from Github:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">'dhaine/misclass'</span>)</div></code></pre>
<p>It is loaded into your session with:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">
<span class="kw">library</span>(misclass)</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="co">#&gt; Loading required package: Rcpp</span></div></code></pre>
<p>The package uses prior Beta distributions for sensitivity and specificity of the diagnostic test(s), and logistic and Poisson 3-level (quarters within cows within herds) regression models for evaluating cluster-specific association (odds ratio) and incidence. The models are implemented using the <a href="http://mc-stan.org/">Stan</a> modelling language.</p>
<section id="creating-an-hypothetical-cohort-study" class="level2"><h2>Creating an hypothetical cohort study</h2>
<p>The function <code>make_data</code> allows the creation of datasets simulating an hypothetical cohort study. Since correlation structures are often found in udder health studies, the generated datasets are deemed to have occurred from the collection of two milk samples collected 1 month apart from each quarters of a random sample of cows per herd, from a given number of dairy herds. The first milk sample (S<sub>1</sub>) is used to identify quarters at risk of intramammary infection (IMI) at the beginning of the cohort, while the second (S<sub>2</sub>) is used to identify the outcome (acquisition of a new IMI). Three hypothetical exposures <code>E_q</code>, <code>E_c</code>, <code>E_h</code> (quarter, cow, and herd level) with known strength of association are generated. As it is often the case <span class="citation" data-cites="dufour2012">(Dufour et al. 2012)</span>, exposures are equally associated with odds of a prevalent IMI on first milk sample as with odds of IMI acquisition on second sample. Exposures are randomly associated with odds of eliminating an existing IMI (OR = 1.0). If <em>S. aureus</em> or CNS (coagulase-negative staphylococci) is chosen, default parameters are used. Otherwise user has to provide his/her own.</p>
<p>So let’s say our researcher wants to run a longitudinal study where he/she will recruit 20 herds, and within each herd 20 cows will be sampled.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">sim_list &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>, <span class="dv">10</span>)</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">
<span class="kw">set.seed</span>(<span class="dv">123</span>)</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3">sim_list &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dt">n =</span> <span class="dv">10</span>, <span class="dt">expr =</span> <span class="kw"><a href="../reference/make_data.html">make_data</a></span>(<span class="dv">20</span>, <span class="dv">20</span>, <span class="st">"cns"</span>), <span class="dt">simplify =</span> <span class="ot">FALSE</span>)</div></code></pre>
<p>In the above code, first five empty lists are created that will hold the simulated datasets. Then a seed is set for reproducibility. Then the <code>make_data</code> function is used to create a dataset made of 20 herds, 20 cows per herd, with the default parameter values for CNS (see <code><a href="../reference/make_data.html">?make_data</a></code> for setting parameters). This is replicated 10 times to allow for 10 simulations later on.</p>
<p>Increasing Se and/or Sp is commonly achieved in udder health studies by carrying on duplicate or triplicate samplings with parallel or series interpretation. The gains or losses in Se/Sp are added/substracted to/from the original distributions for Se and Sp, and biased S<sub>1</sub>‘and S<sub>2</sub>’ variables are generated. Note that you can replace duplicate/triplicate samplings by whatever value you hope a different test would bring to your study.</p>
</section><section id="checking-presence-of-bias-for-association-measure" class="level2"><h2>Checking presence of bias for association measure</h2>
<p>The <code>check_bias</code> function fit a Bayesian logistic regression model to evaluate the true association, and the association in presence of selection and/or misclassification bias.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">bias_or &lt;-<span class="st"> </span><span class="kw"><a href="../reference/check_bias.html">check_bias</a></span>(sim_list,</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">                      <span class="dt">iter =</span> <span class="dv">250</span>,</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3">                      <span class="dt">warmup =</span> <span class="dv">50</span>,</div>
<div class="sourceLine" id="4" href="#4" data-line-number="4">                      <span class="dt">chains =</span> <span class="dv">1</span>,</div>
<div class="sourceLine" id="5" href="#5" data-line-number="5">                      <span class="dt">cores =</span> <span class="dv">1</span>,</div>
<div class="sourceLine" id="6" href="#6" data-line-number="6">                      <span class="dt">seed =</span> <span class="dv">123</span>,</div>
<div class="sourceLine" id="7" href="#7" data-line-number="7">                      <span class="dt">nsimul =</span> <span class="dv">10</span>)</div></code></pre>
<p>The object created, <code>bias_or</code> is a list holding the results for the 10 simulations with, for each simulation, the values for the incidence (the first 5 elements of the list, as we ran 5 simulations), i.e. true association, single sample, selection bias only, and misclassification bias only, and diagnostic parameters in the next 5 elements of the list (Rhat, n_eff, etc.). You can use <code>str(bias_or)</code> to check the structure of this list.</p>
<p>We can put each together into separate matrices:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">diag &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, bias_or[<span class="dv">11</span><span class="op">:</span><span class="dv">20</span>])</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">bias_check &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, bias_or[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</div></code></pre>
<section id="diagnostics" class="level3"><h3>Diagnostics</h3>
<p>You can run several diagnostics checks. More info on diagnostics can be found on the <a href="https://github.com/stan-dev/stan/wiki/Stan-Best-Practices">Stan wiki</a> page.</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">## Distribution of Rhat </div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">
<span class="kw">hist</span>(diag[, <span class="dv">1</span>])</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3">## Ratio n_eff/sample_size</div>
<div class="sourceLine" id="4" href="#4" data-line-number="4">
<span class="kw">hist</span>(diag[, <span class="dv">2</span>] <span class="op">/</span><span class="st"> </span>diag[, <span class="dv">3</span>])</div></code></pre>
<p><img src="misclass_files/figure-html/unnamed-chunk-6-1.png" width="672"><img src="misclass_files/figure-html/unnamed-chunk-6-2.png" width="672"></p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">Rh &lt;-<span class="st"> </span>diag[, <span class="dv">1</span>]</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">Rh[Rh <span class="op">&gt;</span><span class="st"> </span><span class="fl">1.1</span>]</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3"><span class="co">#&gt; numeric(0)</span></div>
<div class="sourceLine" id="4" href="#4" data-line-number="4">
<span class="kw">summary</span>(diag)</div>
<div class="sourceLine" id="5" href="#5" data-line-number="5"><span class="co">#&gt;       Rhat            n_eff        sample_size    divergent</span></div>
<div class="sourceLine" id="6" href="#6" data-line-number="6"><span class="co">#&gt;  Min.   :0.9950   Min.   :110.1   Min.   :200   Min.   :0  </span></div>
<div class="sourceLine" id="7" href="#7" data-line-number="7"><span class="co">#&gt;  1st Qu.:0.9956   1st Qu.:200.0   1st Qu.:200   1st Qu.:0  </span></div>
<div class="sourceLine" id="8" href="#8" data-line-number="8"><span class="co">#&gt;  Median :0.9965   Median :200.0   Median :200   Median :0  </span></div>
<div class="sourceLine" id="9" href="#9" data-line-number="9"><span class="co">#&gt;  Mean   :0.9991   Mean   :195.1   Mean   :200   Mean   :0  </span></div>
<div class="sourceLine" id="10" href="#10" data-line-number="10"><span class="co">#&gt;  3rd Qu.:1.0002   3rd Qu.:200.0   3rd Qu.:200   3rd Qu.:0  </span></div>
<div class="sourceLine" id="11" href="#11" data-line-number="11"><span class="co">#&gt;  Max.   :1.0386   Max.   :200.0   Max.   :200   Max.   :0  </span></div>
<div class="sourceLine" id="12" href="#12" data-line-number="12"><span class="co">#&gt;    treedepth    </span></div>
<div class="sourceLine" id="13" href="#13" data-line-number="13"><span class="co">#&gt;  Min.   :6.000  </span></div>
<div class="sourceLine" id="14" href="#14" data-line-number="14"><span class="co">#&gt;  1st Qu.:7.000  </span></div>
<div class="sourceLine" id="15" href="#15" data-line-number="15"><span class="co">#&gt;  Median :7.000  </span></div>
<div class="sourceLine" id="16" href="#16" data-line-number="16"><span class="co">#&gt;  Mean   :6.975  </span></div>
<div class="sourceLine" id="17" href="#17" data-line-number="17"><span class="co">#&gt;  3rd Qu.:7.000  </span></div>
<div class="sourceLine" id="18" href="#18" data-line-number="18"><span class="co">#&gt;  Max.   :7.000</span></div></code></pre>
</section></section><section id="assess-bias" class="level2"><h2>Assess bias</h2>
<p>A summary of the different OR can be obtained:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">
<span class="kw">summary</span>(bias_check)</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2"><span class="co">#&gt;      post_t            post_s            post_ss          post_sm       </span></div>
<div class="sourceLine" id="3" href="#3" data-line-number="3"><span class="co">#&gt;  Min.   :-0.1545   Min.   :-0.06405   Min.   :0.1483   Min.   :-0.2866  </span></div>
<div class="sourceLine" id="4" href="#4" data-line-number="4"><span class="co">#&gt;  1st Qu.: 0.6777   1st Qu.: 0.50420   1st Qu.:0.9036   1st Qu.: 0.3778  </span></div>
<div class="sourceLine" id="5" href="#5" data-line-number="5"><span class="co">#&gt;  Median : 0.9611   Median : 0.62898   Median :1.1037   Median : 0.5438  </span></div>
<div class="sourceLine" id="6" href="#6" data-line-number="6"><span class="co">#&gt;  Mean   : 0.9707   Mean   : 0.63057   Mean   :1.1035   Mean   : 0.5457  </span></div>
<div class="sourceLine" id="7" href="#7" data-line-number="7"><span class="co">#&gt;  3rd Qu.: 1.2407   3rd Qu.: 0.75136   3rd Qu.:1.2981   3rd Qu.: 0.7058  </span></div>
<div class="sourceLine" id="8" href="#8" data-line-number="8"><span class="co">#&gt;  Max.   : 2.5453   Max.   : 1.42039   Max.   :2.2034   Max.   : 1.4059</span></div>
<div class="sourceLine" id="9" href="#9" data-line-number="9"></div>
<div class="sourceLine" id="10" href="#10" data-line-number="10">
<span class="kw">exp</span>(<span class="kw">median</span>(bias_check[, <span class="dv">1</span>]))</div>
<div class="sourceLine" id="11" href="#11" data-line-number="11"><span class="co">#&gt; [1] 2.614548</span></div>
<div class="sourceLine" id="12" href="#12" data-line-number="12">
<span class="kw">exp</span>(<span class="kw">median</span>(bias_check[, <span class="dv">4</span>]))</div>
<div class="sourceLine" id="13" href="#13" data-line-number="13"><span class="co">#&gt; [1] 1.722491</span></div></code></pre>
<p>We see that the misclassification bias move the association towards the null value (OR of 1.72 versus true OR of 2.61).</p>
<p>We can generate a density plot to visualize the posterior distributions. But first let’s write a function to “densify” the data:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">## Densify data to be used in a density plot </div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">densify &lt;-<span class="st"> </span><span class="cf">function</span>(df, simul) {</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3">    ncolumns &lt;-<span class="st"> </span><span class="kw">ncol</span>(df)</div>
<div class="sourceLine" id="4" href="#4" data-line-number="4">    dflist &lt;-<span class="st"> </span><span class="kw">list</span>()</div>
<div class="sourceLine" id="5" href="#5" data-line-number="5">    CrI &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> ncolumns, <span class="dt">ncol =</span> <span class="dv">3</span>)</div>
<div class="sourceLine" id="6" href="#6" data-line-number="6">    <span class="kw">colnames</span>(CrI) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"q2.5"</span>, <span class="st">"q50"</span>, <span class="st">"q97.5"</span>)</div>
<div class="sourceLine" id="7" href="#7" data-line-number="7">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>ncolumns) {</div>
<div class="sourceLine" id="8" href="#8" data-line-number="8">        pre.dens &lt;-<span class="st"> </span>reshape2<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/reshape2/topics/melt">melt</a></span>(df[, i])</div>
<div class="sourceLine" id="9" href="#9" data-line-number="9">        pre.dens &lt;-<span class="st"> </span><span class="kw">exp</span>(pre.dens)</div>
<div class="sourceLine" id="10" href="#10" data-line-number="10">        CrI[i, ] &lt;-<span class="st"> </span><span class="kw">quantile</span>(df[, i], <span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.5</span>, <span class="fl">.975</span>))</div>
<div class="sourceLine" id="11" href="#11" data-line-number="11">        dens &lt;-<span class="st"> </span><span class="kw">density</span>(pre.dens<span class="op">$</span>value)</div>
<div class="sourceLine" id="12" href="#12" data-line-number="12">        dens &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> dens<span class="op">$</span>x, <span class="dt">y =</span> dens<span class="op">$</span>y)</div>
<div class="sourceLine" id="13" href="#13" data-line-number="13">        dens<span class="op">$</span>simul &lt;-<span class="st"> </span>simul[i]</div>
<div class="sourceLine" id="14" href="#14" data-line-number="14">        dflist[[i]] &lt;-<span class="st"> </span>dens</div>
<div class="sourceLine" id="15" href="#15" data-line-number="15">    }</div>
<div class="sourceLine" id="16" href="#16" data-line-number="16">    densified &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, dflist)</div>
<div class="sourceLine" id="17" href="#17" data-line-number="17">    out_list &lt;-<span class="st"> </span><span class="kw">list</span>(densified, CrI)</div>
<div class="sourceLine" id="18" href="#18" data-line-number="18">    out_list</div>
<div class="sourceLine" id="19" href="#19" data-line-number="19">}</div>
<div class="sourceLine" id="20" href="#20" data-line-number="20"></div>
<div class="sourceLine" id="21" href="#21" data-line-number="21">bias_dens &lt;-<span class="st"> </span><span class="kw">densify</span>(bias_check,</div>
<div class="sourceLine" id="22" href="#22" data-line-number="22">                     <span class="dt">simul =</span> <span class="kw">c</span>(<span class="st">"True association"</span>,</div>
<div class="sourceLine" id="23" href="#23" data-line-number="23">                               <span class="st">"Single sample"</span>,</div>
<div class="sourceLine" id="24" href="#24" data-line-number="24">                               <span class="st">"Selection bias only"</span>,</div>
<div class="sourceLine" id="25" href="#25" data-line-number="25">                               <span class="st">"Misclassificiation bias only"</span>))</div></code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">
<span class="kw">library</span>(ggplot2)</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">
<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(bias_dens[[<span class="dv">1</span>]], <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(x, y, <span class="dt">colour =</span> simul)) <span class="op">+</span>
</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>() <span class="op">+</span>
</div>
<div class="sourceLine" id="4" href="#4" data-line-number="4">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">xlab</a></span>(<span class="st">"Odds ratio"</span>) <span class="op">+</span>
</div>
<div class="sourceLine" id="5" href="#5" data-line-number="5">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">ylab</a></span>(<span class="st">"Density"</span>) <span class="op">+</span>
</div>
<div class="sourceLine" id="6" href="#6" data-line-number="6">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/coord_cartesian">coord_cartesian</a></span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>)) <span class="op">+</span>
</div>
<div class="sourceLine" id="7" href="#7" data-line-number="7">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/scale_continuous">scale_x_continuous</a></span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">1</span>)) <span class="op">+</span>
</div>
<div class="sourceLine" id="8" href="#8" data-line-number="8">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/guides">guides</a></span>(<span class="dt">colour =</span> <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/guide_legend">guide_legend</a></span>(<span class="dt">title =</span> <span class="ot">NULL</span>)) <span class="op">+</span>
</div>
<div class="sourceLine" id="9" href="#9" data-line-number="9">
<span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/theme">theme</a></span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">7</span>, <span class="fl">.7</span>))</div></code></pre>
<p><img src="misclass_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
</section><section id="checking-the-effect-of-different-sampling-strategies" class="level2"><h2>Checking the effect of different sampling strategies</h2>
<p>The same can be done for evaluating the effect of duplicate or triplicate samplings (i.e., modifying the Se/Sp). We’re not running the code but it would be:</p>
<pre class="sourceCode r"><code class="sourceCode r"><div class="sourceLine" id="1" href="#1" data-line-number="1">stgy_or &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sample_stgy.html">sample_stgy</a></span>(sim_list,</div>
<div class="sourceLine" id="2" href="#2" data-line-number="2">                       <span class="dt">iter =</span> <span class="dv">250</span>,</div>
<div class="sourceLine" id="3" href="#3" data-line-number="3">                       <span class="dt">warmup =</span> <span class="dv">50</span>,</div>
<div class="sourceLine" id="4" href="#4" data-line-number="4">                       <span class="dt">chains =</span> <span class="dv">1</span>,</div>
<div class="sourceLine" id="5" href="#5" data-line-number="5">                       <span class="dt">cores =</span> <span class="dv">1</span>,</div>
<div class="sourceLine" id="6" href="#6" data-line-number="6">                       <span class="dt">seed =</span> <span class="dv">123</span>,</div>
<div class="sourceLine" id="7" href="#7" data-line-number="7">                       <span class="dt">nsimul =</span> <span class="dv">10</span>)</div></code></pre>
</section><section id="measure-of-incidence" class="level2"><h2>Measure of incidence</h2>
<p>Instead of using <code>check_bias</code> and <code>smply_stgy</code> functions, you use <code>check_incidence</code> and <code>sample_incidence</code>, respectively.</p>
<p>Note that Poisson models are slower to converge.</p>
</section><section id="references" class="level2 unnumbered"><h2>References</h2>
<div id="refs" class="references">
<div id="ref-dufour2012">
<p>Dufour, Simon, Ian Dohoo, Herman Barkema, Luc DesCôteaux, Trevor DeVries, Kristen Reyher, and Daniel Scholl. 2012. “Epidemiology of Coagulase-Negative Staphylococci Intramammary Infection in Dairy Cattle and the Effect of Bacteriological Culture Misclassification.” <em>Journal of Dairy Sciences</em> 95 (6): 3110–24.</p>
</div>
</div>
</section>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#creating-an-hypothetical-cohort-study">Creating an hypothetical cohort study</a></li>
      <li><a href="#checking-presence-of-bias-for-association-measure">Checking presence of bias for association measure</a></li>
      <li><a href="#assess-bias">Assess bias</a></li>
      <li><a href="#checking-the-effect-of-different-sampling-strategies">Checking the effect of different sampling strategies</a></li>
      <li><a href="#measure-of-incidence">Measure of incidence</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Denis Haine, Simon Dufour, Henryk Stryhn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
